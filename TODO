DONE

	Fix as many packet sends as possible to use the new functions.

	Add current and previous magic to pending, proxy and session entries.

TODO

	--------------

	Server needs to track upcoming, current and previous magic values.

	Upcoming is the latest value from the server backend.

	When it changes, there is a 30 second timer before we move current -> previous, and upcoming -> current.

	Do this next!

	--------------

	Actually track current and previous magic in session entries

	Must be done in pending, proxy and current...

	--------------

	Hook up and store the current magic in the session entry (from the upgrade response)

	Hook up and store the current magic, move to prev, in the session entry (from the route update ack)

	Actually use the current magic for session to send packet to client (but only for direct to client packets...)

	--------------

	Add concept of relay_magic, 30 second delayed from current -- this relay magic ensures that we can talk with relays without race.

	Actually use the relay magic when sending packets to relays from the server.

	Client also sends packets to relays, so the client should be driven from the relay magic as well... yowza.

	--------------

	Get the client/server upgrade working and the upgraded direct packets being exchanged between client and server.

	--------------

	Update the func backend 5 so it can handle new SDK5 packet types.

	--------------

	Get various upgraded direct func tests passing.

	--------------

	========================================================

	--------------

	Work out how to get ping tokens down to the client

	--------------

	Get the client pinging near relays w. ping tokens and getting responses.

	--------------

	Update the reference relay so it can handle the new SDK5 packet types.

	--------------

	Get an actual end-to-end network next route going with SDK5 client/server.

	--------------

	Get the rest of the func tests passing.

	--------------

	=================================================

	--------------

	Move server whois to the backend, it's unreliable when run on the SDK server
	and the iteration time for fixes (new SDK deploy) is just too long.

	--------------

